# COBOL èˆŠç³»çµ±æ–‡æª” â†’ Node.js ç¾ä»£åŒ–å¯¦ä½œ

## ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸæœ¬ä»¥ COBOL ç·¨å¯«çš„å­¸ç”Ÿå¸³æˆ¶ç®¡ç†ç³»çµ±ï¼Œç¾å·²ç¾ä»£åŒ–ç‚º Node.js æ‡‰ç”¨ç¨‹å¼ã€‚ç³»çµ±æä¾›åŸºæœ¬çš„å¸³æˆ¶é¤˜é¡æŸ¥è©¢ã€å­˜æ¬¾ï¼ˆå…¥å¸³ï¼‰å’Œææ¬¾ï¼ˆæ‰£æ¬¾ï¼‰åŠŸèƒ½ï¼Œæ¡ç”¨æ¨¡çµ„åŒ–è¨­è¨ˆã€‚

### èˆŠç³»çµ± (COBOL) vs æ–°ç³»çµ± (Node.js)

| é¢å‘ | COBOL åŸç³»çµ± | Node.js ç¾ä»£åŒ–ç‰ˆæœ¬ |
|---|---|---|
| **ç¨‹å¼èªè¨€** | COBOL | JavaScript (Node.js) |
| **æ¶æ§‹** | ä¸‰å€‹ç¨ç«‹ç¨‹å¼ (main.cob, operations.cob, data.cob) | å–®ä¸€ library (`AccountManager.js`) + CLI (`MainProgram`) |
| **æ¥­å‹™é‚è¼¯** | åˆ†æ•£åœ¨ operations.cob | çµ±ä¸€åœ¨ `AccountManager.js` |
| **UIå±¤** | main.cob å…§çš„èœå–®é‚è¼¯ | `MainProgram` é¡ (index.js) |
| **è³‡æ–™å±¤** | data.cob ä¸­çš„è¨˜æ†¶é«”å„²å­˜ | `AccountManager.balance` å±¬æ€§ |
| **é‡ç”¨æ€§** | éœ€è¦ç·¨è­¯ä¸¦ CALL å…¶ä»–ç¨‹å¼ | ç›´æ¥ import `AccountManager` é¡ |
| **æ¸¬è©¦** | æ‰‹å‹•æˆ–å¤–éƒ¨æ¸¬è©¦å·¥å…· | Jest å–®å…ƒæ¸¬è©¦ + Jest æ•´åˆæ¸¬è©¦ |

---

## ç¨‹å¼æª”æ¡ˆèªªæ˜ (COBOL åŸç³»çµ±)

### 1. main.cob - ä¸»ç¨‹å¼

**ç”¨é€”ï¼š**  
ç³»çµ±çš„ä¸»è¦å…¥å£é»ï¼Œè² è²¬ä½¿ç”¨è€…ä»‹é¢å’Œæ“ä½œæµç¨‹æ§åˆ¶ã€‚

**é—œéµåŠŸèƒ½ï¼š**
- é¡¯ç¤ºäº’å‹•å¼é¸å–®ä»‹é¢
- æ¥æ”¶ä½¿ç”¨è€…çš„æ“ä½œé¸æ“‡ï¼ˆ1-4ï¼‰
- æ ¹æ“šä½¿ç”¨è€…é¸æ“‡èª¿ç”¨å°æ‡‰çš„æ“ä½œæ¨¡çµ„
- æ§åˆ¶ç¨‹å¼çš„åŸ·è¡Œå¾ªç’°ï¼Œç›´åˆ°ä½¿ç”¨è€…é¸æ“‡é€€å‡º

**æ“ä½œé¸é …ï¼š**
1. **æŸ¥çœ‹é¤˜é¡** - èª¿ç”¨ Operations ç¨‹å¼é¡¯ç¤ºç•¶å‰å¸³æˆ¶é¤˜é¡
2. **å…¥å¸³ï¼ˆå­˜æ¬¾ï¼‰** - èª¿ç”¨ Operations ç¨‹å¼è™•ç†å­˜æ¬¾æ“ä½œ
3. **æ‰£æ¬¾ï¼ˆææ¬¾ï¼‰** - èª¿ç”¨ Operations ç¨‹å¼è™•ç†ææ¬¾æ“ä½œ
4. **é€€å‡ºç³»çµ±** - çµ‚æ­¢ç¨‹å¼åŸ·è¡Œ

**æ¥­å‹™è¦å‰‡ï¼š**
- ä½¿ç”¨è€…å¿…é ˆè¼¸å…¥ 1-4 ä¹‹é–“çš„æ•¸å­—
- ç„¡æ•ˆè¼¸å…¥æœƒé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ä¸¦é‡æ–°é¡¯ç¤ºé¸å–®
- ç¨‹å¼æŒçºŒé‹è¡Œç›´åˆ°ä½¿ç”¨è€…æ˜ç¢ºé¸æ“‡é€€å‡º

---

### 2. operations.cob - æ¥­å‹™é‚è¼¯è™•ç†ç¨‹å¼

**ç”¨é€”ï¼š**  
è™•ç†æ‰€æœ‰èˆ‡å­¸ç”Ÿå¸³æˆ¶ç›¸é—œçš„æ¥­å‹™æ“ä½œé‚è¼¯ï¼Œæ˜¯ç³»çµ±çš„æ ¸å¿ƒæ¥­å‹™å±¤ã€‚

**é—œéµåŠŸèƒ½ï¼š**

#### æŸ¥è©¢é¤˜é¡ (TOTAL)
- å¾è³‡æ–™å±¤è®€å–ç•¶å‰å¸³æˆ¶é¤˜é¡
- åœ¨è¢å¹•ä¸Šé¡¯ç¤ºç•¶å‰é¤˜é¡

#### å…¥å¸³æ“ä½œ (CREDIT)
- æç¤ºä½¿ç”¨è€…è¼¸å…¥å­˜æ¬¾é‡‘é¡
- è®€å–ç•¶å‰é¤˜é¡
- å°‡å­˜æ¬¾é‡‘é¡åŠ åˆ°ç•¶å‰é¤˜é¡
- å°‡æ›´æ–°å¾Œçš„é¤˜é¡å¯«å›è³‡æ–™å±¤
- é¡¯ç¤ºäº¤æ˜“æˆåŠŸè¨Šæ¯å’Œæ–°é¤˜é¡

#### æ‰£æ¬¾æ“ä½œ (DEBIT)
- æç¤ºä½¿ç”¨è€…è¼¸å…¥ææ¬¾é‡‘é¡
- è®€å–ç•¶å‰é¤˜é¡
- é©—è­‰å¸³æˆ¶é¤˜é¡æ˜¯å¦è¶³å¤ 
- å¦‚æœé¤˜é¡å……è¶³ï¼š
  - å¾ç•¶å‰é¤˜é¡æ‰£é™¤ææ¬¾é‡‘é¡
  - å°‡æ›´æ–°å¾Œçš„é¤˜é¡å¯«å›è³‡æ–™å±¤
  - é¡¯ç¤ºäº¤æ˜“æˆåŠŸè¨Šæ¯å’Œæ–°é¤˜é¡
- å¦‚æœé¤˜é¡ä¸è¶³ï¼š
  - é¡¯ç¤ºã€Œé¤˜é¡ä¸è¶³ã€éŒ¯èª¤è¨Šæ¯
  - ä¸åŸ·è¡Œæ‰£æ¬¾æ“ä½œ

**æ¥­å‹™è¦å‰‡ï¼š**
- **é¤˜é¡é©—è­‰**ï¼šæ‰£æ¬¾å‰å¿…é ˆæª¢æŸ¥å¸³æˆ¶é¤˜é¡æ˜¯å¦è¶³å¤ 
- **äº¤æ˜“åŸå­æ€§**ï¼šæ¯æ¬¡æ“ä½œéƒ½åŒ…å«è®€å–ã€è¨ˆç®—å’Œå¯«å…¥ä¸‰å€‹æ­¥é©Ÿ
- **è³‡æ–™ä¸€è‡´æ€§**ï¼šæ‰€æœ‰é¤˜é¡è®Šæ›´éƒ½å¿…é ˆé€šéè³‡æ–™å±¤é€²è¡Œ
- **é˜²æ­¢é€æ”¯**ï¼šç³»çµ±ä¸å…è¨±å¸³æˆ¶é¤˜é¡è®Šæˆè² æ•¸

---

### 3. data.cob - è³‡æ–™å­˜å–å±¤

**ç”¨é€”ï¼š**  
æä¾›å¸³æˆ¶é¤˜é¡è³‡æ–™çš„å­˜å„²å’Œå­˜å–åŠŸèƒ½ï¼Œä½œç‚ºç³»çµ±çš„è³‡æ–™æŒä¹…å±¤ã€‚

**é—œéµåŠŸèƒ½ï¼š**

#### è®€å–æ“ä½œ (READ)
- å°‡å„²å­˜çš„å¸³æˆ¶é¤˜é¡å‚³å›çµ¦èª¿ç”¨ç¨‹å¼
- ç”¨æ–¼æŸ¥è©¢ç•¶å‰é¤˜é¡æˆ–åœ¨äº¤æ˜“å‰å–å¾—æœ€æ–°é¤˜é¡

#### å¯«å…¥æ“ä½œ (WRITE)
- æ¥æ”¶æ–°çš„å¸³æˆ¶é¤˜é¡ä¸¦æ›´æ–°å…§éƒ¨å„²å­˜
- ç”¨æ–¼åœ¨äº¤æ˜“å®Œæˆå¾Œä¿å­˜æ–°é¤˜é¡

**è³‡æ–™çµæ§‹ï¼š**
- `STORAGE-BALANCE`ï¼šæŒä¹…åŒ–å„²å­˜çš„å¸³æˆ¶é¤˜é¡
- é è¨­åˆå§‹å€¼ï¼š1000.00ï¼ˆæ–°å¸³æˆ¶çš„èµ·å§‹é¤˜é¡ï¼‰
- è³‡æ–™å‹åˆ¥ï¼šPIC 9(6)V99ï¼ˆæœ€å¤š 6 ä½æ•´æ•¸ + 2 ä½å°æ•¸ï¼Œç¯„åœï¼š0.00 - 999999.99ï¼‰

**æ¥­å‹™è¦å‰‡ï¼š**
- **åˆå§‹é¤˜é¡**ï¼šæ‰€æœ‰æ–°å­¸ç”Ÿå¸³æˆ¶çš„åˆå§‹é¤˜é¡è¨­å®šç‚º 1000.00
- **é¤˜é¡ä¸Šé™**ï¼šæœ€å¤§é¤˜é¡ç‚º 999,999.99
- **ç²¾ç¢ºåº¦**ï¼šæ‰€æœ‰é‡‘é¡è¨ˆç®—ä¿ç•™å…©ä½å°æ•¸
- **è³‡æ–™å°è£**ï¼šæ‰€æœ‰é¤˜é¡å­˜å–å¿…é ˆé€šéæ­¤ç¨‹å¼çš„ READ/WRITE ä»‹é¢

---

## ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   main.cob      â”‚ â† ä½¿ç”¨è€…ä»‹é¢å±¤
â”‚  (ä¸»ç¨‹å¼)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ CALL
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ operations.cob  â”‚ â† æ¥­å‹™é‚è¼¯å±¤
â”‚  (æ¥­å‹™è™•ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ CALL
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   data.cob      â”‚ â† è³‡æ–™å­˜å–å±¤
â”‚  (è³‡æ–™ç®¡ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Node.js ç¾ä»£åŒ–å¯¦ä½œ

### æª”æ¡ˆçµæ§‹

```
src/accounting/
â”œâ”€â”€ AccountManager.js          â† æ ¸å¿ƒæ¥­å‹™é‚è¼¯åº« (pure library)
â”œâ”€â”€ index.js                   â† CLI å…¥å£é» + æ¸¬è©¦é©é…å™¨
â”œâ”€â”€ AccountManager.test.js     â† å–®å…ƒæ¸¬è©¦
â”œâ”€â”€ index.test.js              â† æ•´åˆæ¸¬è©¦
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### æ ¸å¿ƒè¨­è¨ˆï¼šAccountManager åº«

**æª”æ¡ˆ**: `src/accounting/AccountManager.js`

`AccountManager` æ˜¯çµ±ä¸€çš„æ¥­å‹™é‚è¼¯åº«ï¼Œå–ä»£äº†åŸ COBOL çš„ operations.cob å’Œ data.cob çš„é‚è¼¯ï¼š

#### å…¬é–‹ä»‹é¢

```javascript
class AccountManager {
  constructor(initialBalance = 1000.00)
  
  // æŸ¥è©¢
  viewBalance()  // è¿”å›ç•¶å‰é¤˜é¡
  
  // äº¤æ˜“
  creditAccount(amount)   // å­˜å…¥ï¼Œè¿”å› {success, message, balance}
  debitAccount(amount)    // ææ¬¾ï¼Œè¿”å› {success, message, balance}
  
  // å·¥å…·
  formatBalance(balance)  // æ ¼å¼åŒ–ç‚º COBOL é¢¨æ ¼ (9 å­—å…ƒï¼š6 ä½æ•´æ•¸ + å°æ•¸é» + 2 ä½å°æ•¸)
  resetBalance(initialBalance)  // é‡è¨­é¤˜é¡
}
```

#### è¨­è¨ˆç‰¹é»
- **é›¶ä¾è³´**: ä¸ä¾è³´ readline-sync æˆ–ä»»ä½• I/O åº«
- **çµæ§‹åŒ–è¿”å›**: æ‰€æœ‰äº¤æ˜“è¿”å› `{success, message, balance}` ç‰©ä»¶
- **æ¥­å‹™é©—è­‰**: å…§å»ºé©—è­‰é‚è¼¯ï¼ˆå¦‚é˜²æ­¢é€æ”¯ã€æ ¼å¼é©—è­‰ï¼‰
- **å¯é‡ç”¨**: å¯è¢« CLIã€APIã€æ¸¬è©¦ç­‰ä»»ä½•å®¢æˆ¶ç«¯ä½¿ç”¨

### CLI å…¥å£é»ï¼šMainProgram

**æª”æ¡ˆ**: `src/accounting/index.js`

`MainProgram` é¡å¯¦ç¾äº’å‹•å¼èœå–®ï¼Œç›´æ¥ä½¿ç”¨ `AccountManager` é€²è¡Œæ‰€æœ‰æ¥­å‹™é‚è¼¯ï¼š

```javascript
class MainProgram {
  constructor()     // åˆå§‹åŒ– AccountManager å¯¦ä¾‹
  displayMenu()     // é¡¯ç¤ºèœå–®ï¼Œå–å¾—ä½¿ç”¨è€…é¸æ“‡
  run()            // ä¸»è¿´åœˆï¼šé¡¯ç¤ºèœå–® â†’ åŸ·è¡Œæ“ä½œ â†’ é‡è¤‡
}
```

#### æ“ä½œæµç¨‹
1. ä½¿ç”¨è€…é¸æ“‡èœå–®é¸é … (1-4)
2. å¦‚æœé¸æ“‡ 1 (æŸ¥çœ‹é¤˜é¡)ï¼š
   - å‘¼å« `AccountManager.viewBalance()`
   - ä½¿ç”¨ `AccountManager.formatBalance()` æ ¼å¼åŒ–è¼¸å‡º
   - é¡¯ç¤ºçµæœ
3. å¦‚æœé¸æ“‡ 2 (å­˜å…¥)ï¼š
   - ä½¿ç”¨ `getAmountInput()` é©—è­‰ä½¿ç”¨è€…è¼¸å…¥
   - å‘¼å« `AccountManager.creditAccount(amount)`
   - é¡¯ç¤ºçµæœè¨Šæ¯
4. å¦‚æœé¸æ“‡ 3 (ææ¬¾)ï¼š
   - ä½¿ç”¨ `getAmountInput()` é©—è­‰ä½¿ç”¨è€…è¼¸å…¥
   - å‘¼å« `AccountManager.debitAccount(amount)`
   - é¡¯ç¤ºçµæœè¨Šæ¯ï¼ˆæˆåŠŸæˆ–å¤±æ•—ï¼‰
5. å¦‚æœé¸æ“‡ 4 (é€€å‡º)ï¼š
   - çµ‚æ­¢ä¸»è¿´åœˆ

### æ¸¬è©¦é©é…å™¨ (å‘å¾Œç›¸å®¹)

**æª”æ¡ˆ**: `src/accounting/index.js` (DataProgram å’Œ Operations é¡)

ç‚ºäº†ä¿æŒèˆ‡ç¾æœ‰æ¸¬è©¦å¥—ä»¶çš„ç›¸å®¹æ€§ï¼Œæä¾›äº†è–„å°è£çš„é©é…å™¨ï¼š

```javascript
class DataProgram {
  // é©é…å™¨ï¼šå§”æ´¾åˆ° AccountManager
  read()          // â†’ manager.viewBalance()
  write(balance)  // â†’ manager.resetBalance(balance)
}

class Operations {
  // é©é…å™¨ï¼šå§”æ´¾åˆ° AccountManager
  total()                  // é¡¯ç¤ºæ ¼å¼åŒ–çš„é¤˜é¡
  formatBalance(balance)   // â†’ formatter.formatBalance(balance)
}
```

é€™äº›é¡å®Œå…¨å§”æ´¾åˆ° `AccountManager`ï¼Œä¸åŒ…å«ä»»ä½•æ¥­å‹™é‚è¼¯ã€‚

### æ¶æ§‹å°æ¯”

#### COBOL åŸå§‹æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   main.cob      â”‚ â† ä½¿ç”¨è€…ä»‹é¢å±¤
â”‚  (ä¸»ç¨‹å¼)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ CALL
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ operations.cob  â”‚ â† æ¥­å‹™é‚è¼¯å±¤
â”‚  (æ¥­å‹™è™•ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ CALL
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   data.cob      â”‚ â† è³‡æ–™å­˜å–å±¤
â”‚  (è³‡æ–™ç®¡ç†)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Node.js ç¾ä»£åŒ–æ¶æ§‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CLI Entry Point           â”‚
â”‚    (npm start)               â”‚
â”‚    MainProgram.run()         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Input Processing       â”‚
â”‚  Menu Display                â”‚
â”‚  Input Validation            â”‚
â”‚  Output Formatting           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ delegates
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AccountManager Library       â”‚
â”‚ (Pure Business Logic)        â”‚
â”‚                              â”‚
â”‚ â€¢ viewBalance()              â”‚
â”‚ â€¢ creditAccount(amt)         â”‚
â”‚ â€¢ debitAccount(amt)          â”‚
â”‚ â€¢ formatBalance(amt)         â”‚
â”‚ â€¢ resetBalance(amt)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  In-Memory Storage           â”‚
â”‚  (this.balance)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•¸æ“šæµç¨‹

#### æŸ¥çœ‹é¤˜é¡ (View Balance)
```
MainProgram.displayMenu()
    â†“ ä½¿ç”¨è€…é¸æ“‡ 1
getAmountInput() [ä¸éœ€è¦è¼¸å…¥]
    â†“
AccountManager.viewBalance()
    â†“ è¿”å› balance å€¼
AccountManager.formatBalance(balance)
    â†“ è¿”å›æ ¼å¼åŒ–å­—ä¸² (ä¾‹: "001000.00")
console.log("Current balance: 001000.00")
    â†“
è¿”å›é¸å–®
```

#### å­˜å…¥ (Credit) / ææ¬¾ (Debit)
```
MainProgram.displayMenu()
    â†“ ä½¿ç”¨è€…é¸æ“‡ 2 æˆ– 3
getAmountInput(prompt)
    â†“ é©—è­‰ä¸¦è¿”å›æœ‰æ•ˆé‡‘é¡
AccountManager.creditAccount(amount)
æˆ– AccountManager.debitAccount(amount)
    â†“ è¿”å› {success, message, balance}
console.log(result.message)
    â†“ é¡¯ç¤ºäº¤æ˜“çµæœ
è¿”å›é¸å–®
```

---

## æ˜ å°„è¡¨ï¼šCOBOL â†’ Node.js

| COBOL å…ƒç´  | ä½ç½® | Node.js å°æ‡‰ | ä½ç½® |
|---|---|---|---|
| **main.cob** | ä¸»ç¨‹å¼æª”æ¡ˆ | **MainProgram é¡** | index.js |
| main.cob èœå–®é‚è¼¯ | | displayMenu() æ–¹æ³• | index.js |
| main.cob è¿´åœˆæ§åˆ¶ | | run() æ–¹æ³• & continueFlag | index.js |
| **operations.cob** | æ¥­å‹™é‚è¼¯æª”æ¡ˆ | **AccountManager é¡** | AccountManager.js |
| TOTAL æ“ä½œ | operations.cob | viewBalance() | AccountManager.js |
| CREDIT æ“ä½œ | operations.cob | creditAccount() | AccountManager.js |
| DEBIT æ“ä½œ | operations.cob | debitAccount() | AccountManager.js |
| è¼¸å…¥æç¤º & é‡‘é¡é©—è­‰ | operations.cob | getAmountInput() | index.js |
| æ ¼å¼åŒ–è¼¸å‡º | operations.cob | formatBalance() | AccountManager.js |
| **data.cob** | è³‡æ–™å±¤æª”æ¡ˆ | **AccountManager.balance å±¬æ€§** | AccountManager.js |
| READ æ“ä½œ | data.cob | viewBalance() | AccountManager.js |
| WRITE æ“ä½œ | data.cob | resetBalance() | AccountManager.js |
| STORAGE-BALANCE | data.cob | this.balance | AccountManager.js |

---

## æ¥­å‹™è¦å‰‡ä¿ç•™é©—è­‰

### âœ… åˆå§‹åŒ–
- æ¯å€‹å¸³æˆ¶å‰µå»ºæ™‚è‡ªå‹•ç²å¾— 1000.00 åˆå§‹é¤˜é¡ âœ“
- `new AccountManager()` é è¨­åˆå§‹å€¼ç‚º 1000.00

### âœ… é¤˜é¡é™åˆ¶
- æœ€å°é¤˜é¡ï¼š0.00ï¼ˆé˜²æ­¢é€æ”¯ï¼‰ âœ“
  - `debitAccount()` æª¢æŸ¥: `if (finalBalance < 0) return {success: false}`
- æœ€å¤§é¤˜é¡ï¼š999,999.99ï¼ˆCOBOL PIC 9(6)V99ï¼‰ âœ“
  - `creditAccount()` æª¢æŸ¥: `if (newBalance > MAX_BALANCE) return {success: false}`
  - `formatBalance()` å°é ‚: `Math.min(balance, MAX_BALANCE)`

### âœ… ç²¾ç¢ºåº¦
- æ‰€æœ‰é‡‘é¡ä¿ç•™ 2 ä½å°æ•¸ âœ“
  - `newBalance = parseFloat(newBalance.toFixed(2))`
  - è¼¸å‡ºæ ¼å¼: `balance.toFixed(2)`

### âœ… æ ¼å¼åŒ–è¼¸å‡º
- COBOL é¢¨æ ¼æ ¼å¼ (9 å­—å…ƒ) âœ“
  - 6 ä½æ•´æ•¸ï¼ˆå·¦é‚Šè£œé›¶ï¼‰+ å°æ•¸é» + 2 ä½å°æ•¸
  - ç¯„ä¾‹: `001000.00`, `000050.25`, `999999.99`

### âœ… äº¤æ˜“åŸå­æ€§
- æ¯æ¬¡äº¤æ˜“å®Œæ•´: è®€å– â†’ é©—è­‰ â†’ è¨ˆç®— â†’ å¯«å…¥ âœ“
- å¤±æ•—çš„äº¤æ˜“ä¸ä¿®æ”¹ç‹€æ…‹

### âœ… æ“ä½œçµæœè¿”å›
- æˆåŠŸäº¤æ˜“è¿”å›çµæ§‹åŒ–ç‰©ä»¶ âœ“
  ```javascript
  {
    success: true,
    message: "Amount credited. New balance: 001100.00",
    balance: 1100.00
  }
  ```
- å¤±æ•—äº¤æ˜“è¿”å›æ¸…æ™°éŒ¯èª¤è¨Šæ¯ âœ“
  ```javascript
  {
    success: false,
    message: "Insufficient funds for this debit.",
    balance: 1000.00  // é¤˜é¡æœªæ”¹è®Š
  }
  ```

---

## åŸ·è¡Œæ–¹å¼

### é–‹ç™¼ç’°å¢ƒå•Ÿå‹•

```bash
cd src/accounting
npm install
npm start
```

### åŸ·è¡Œæ¸¬è©¦

```bash
# å–®å…ƒæ¸¬è©¦ (AccountManager)
npx jest AccountManager.test.js

# æ•´åˆæ¸¬è©¦ (DataProgram & Operations)
npx jest index.test.js

# æ‰€æœ‰æ¸¬è©¦
npx jest
```

### æ¸¬è©¦æ¶µè“‹

- **TC-001 ~ TC-040**: æ‰€æœ‰åŠŸèƒ½ã€é‚Šç•Œå€¼ã€éŒ¯èª¤è™•ç†ã€æ•´åˆæ¸¬è©¦éƒ½åŒ…å«åœ¨ Jest æ¸¬è©¦ä¸­
- **AccountManager.test.js**: 40 å€‹æ¸¬è©¦æ¡ˆä¾‹å°æ‡‰ TESTPLAN.md
- **index.test.js**: æ¸¬è©¦é©é…å™¨å±¤çš„ç›¸å®¹æ€§

---

1. **å¸³æˆ¶åˆå§‹åŒ–**
   - æ¯å€‹å­¸ç”Ÿå¸³æˆ¶å‰µå»ºæ™‚è‡ªå‹•ç²å¾— 1000.00 çš„åˆå§‹é¤˜é¡

2. **é¤˜é¡é™åˆ¶**
   - æœ€å°é¤˜é¡ï¼š0.00ï¼ˆä¸å…è¨±è² æ•¸/é€æ”¯ï¼‰
   - æœ€å¤§é¤˜é¡ï¼š999,999.99

3. **äº¤æ˜“è¦å‰‡**
   - å­˜æ¬¾ï¼šç„¡é™åˆ¶ï¼Œä»»ä½•æ­£æ•¸é‡‘é¡éƒ½å¯ä»¥å­˜å…¥
   - ææ¬¾ï¼šå¿…é ˆç¢ºä¿é¤˜é¡å……è¶³ï¼Œå¦å‰‡äº¤æ˜“è¢«æ‹’çµ•
   - æ‰€æœ‰é‡‘é¡ä»¥å…©ä½å°æ•¸è¨ˆç®—

4. **è³‡æ–™å®Œæ•´æ€§**
   - æ¯æ¬¡äº¤æ˜“éƒ½æ˜¯è®€å–-è¨ˆç®—-å¯«å…¥çš„å®Œæ•´æµç¨‹
   - é¤˜é¡åªèƒ½é€šé operations æ¨¡çµ„é€²è¡Œä¿®æ”¹
   - è³‡æ–™å­˜å–çµ±ä¸€é€šé data æ¨¡çµ„é€²è¡Œ

5. **ä½¿ç”¨è€…ä»‹é¢**
   - æä¾›æ¸…æ™°çš„é¸å–®å°èˆª
   - æ‰€æœ‰æ“ä½œéƒ½æœ‰å³æ™‚å›é¥‹
   - éŒ¯èª¤æƒ…æ³æœƒé¡¯ç¤ºæ˜ç¢ºçš„æç¤ºè¨Šæ¯

---

## æŠ€è¡“è¦æ ¼

- **ç¨‹å¼èªè¨€**ï¼šCOBOL
- **è³‡æ–™å‹åˆ¥**ï¼šPIC 9(6)V99ï¼ˆé‡‘é¡ï¼‰ã€PIC Xï¼ˆæ–‡å­—ï¼‰ã€PIC 9ï¼ˆæ•¸å­—é¸é …ï¼‰
- **æ¨¡çµ„é€šè¨Š**ï¼šä½¿ç”¨ CALL èªå¥é€²è¡Œç¨‹å¼é–“èª¿ç”¨
- **åƒæ•¸å‚³é**ï¼šä½¿ç”¨ USING å­å¥å‚³éåƒæ•¸
- **æ§åˆ¶æµç¨‹**ï¼šPERFORM UNTILã€EVALUATEã€IF-ELSE

---

## æœªä¾†ç¾ä»£åŒ–å»ºè­°

1. **è³‡æ–™æŒä¹…åŒ–**ï¼šç›®å‰é¤˜é¡åƒ…å„²å­˜åœ¨è¨˜æ†¶é«”ä¸­ï¼Œå»ºè­°é€£æ¥è³‡æ–™åº«
2. **å¤šå¸³æˆ¶æ”¯æ´**ï¼šæ“´å±•ç‚ºæ”¯æ´å¤šå€‹å­¸ç”Ÿå¸³æˆ¶çš„ç®¡ç†
3. **äº¤æ˜“è¨˜éŒ„**ï¼šå¢åŠ äº¤æ˜“æ­·å²è¨˜éŒ„åŠŸèƒ½
4. **å®‰å…¨æ€§**ï¼šå¢åŠ èº«ä»½é©—è­‰å’Œæˆæ¬Šæ©Ÿåˆ¶
5. **å ±è¡¨åŠŸèƒ½**ï¼šæä¾›å¸³æˆ¶å ±è¡¨å’Œçµ±è¨ˆè³‡è¨Š
6. **éŒ¯èª¤è™•ç†**ï¼šå¢å¼·éŒ¯èª¤è™•ç†å’Œç•°å¸¸ç®¡ç†æ©Ÿåˆ¶

---

## è³‡æ–™æµç¨‹åœ–

### å®Œæ•´ç³»çµ±æµç¨‹

```mermaid
graph TD
    A["ğŸ‘¤ ä½¿ç”¨è€…"] -->|è¼¸å…¥é¸æ“‡| B["ğŸ“‹ main.cob<br/>ä¸»ç¨‹å¼"]
    
    B -->|é¸é … 1| C["ğŸ” æŸ¥çœ‹é¤˜é¡"]
    B -->|é¸é … 2| D["ğŸ’° å­˜æ¬¾"]
    B -->|é¸é … 3| E["ğŸ’¸ ææ¬¾"]
    B -->|é¸é … 4| F["ğŸšª é€€å‡º"]
    
    C -->|TOTAL| G["operations.cob<br/>æ¥­å‹™æ“é‚"]
    D -->|CREDIT| G
    E -->|DEBIT| G
    
    G -->|READ| H["ğŸ“ data.cob<br/>è³‡æ–™å­˜å–"]
    G -->|è¨ˆç®—| I["ğŸ§® æ¥­å‹™é‚è¼¯è™•ç†"]
    I -->|é©—è­‰<br/>æ‰£æ¬¾æª¢æŸ¥| J{"é¤˜é¡<br/>å……è¶³?"}
    
    J -->|æ˜¯| K["WRITE"]
    J -->|å¦| L["âŒ äº¤æ˜“æ‹’çµ•"]
    
    K --> H
    H -->|æ›´æ–°/è¿”å›<br/>STORAGE-BALANCE| G
    
    G -->|çµæœ| M["ğŸ“Š é¡¯ç¤ºçµæœ"]
    M -->|äº¤æ˜“å®Œæˆ| B
    L -->|éŒ¯èª¤è¨Šæ¯| B
    
    F --> N["ğŸ ç¨‹å¼çµæŸ"]
    
    style A fill:#e1f5ff
    style B fill:#fff3e0
    style G fill:#f3e5f5
    style H fill:#e8f5e9
    style M fill:#fce4ec
    style N fill:#f1f8e9
```

### æŸ¥çœ‹é¤˜é¡æµç¨‹ (TOTAL)

```mermaid
sequenceDiagram
    participant ç”¨æˆ¶ as ğŸ‘¤ ä½¿ç”¨è€…
    participant Main as ğŸ“‹ main.cob
    participant Ops as ğŸ”§ operations.cob
    participant Data as ğŸ“ data.cob
    
    ç”¨æˆ¶->>Main: é¸æ“‡ 1. æŸ¥çœ‹é¤˜é¡
    Main->>Ops: CALL 'Operations' USING 'TOTAL '
    Ops->>Data: CALL 'DataProgram' USING 'READ'
    Data-->>Ops: è¿”å› FINAL-BALANCE
    Ops-->>Main: é¡¯ç¤º: ç•¶å‰é¤˜é¡: 1000.00
    Main-->>ç”¨æˆ¶: è¿”å›é¸å–®
```

### å­˜æ¬¾æµç¨‹ (CREDIT)

```mermaid
sequenceDiagram
    participant ç”¨æˆ¶ as ğŸ‘¤ ä½¿ç”¨è€…
    participant Main as ğŸ“‹ main.cob
    participant Ops as ğŸ”§ operations.cob
    participant Data as ğŸ“ data.cob
    
    ç”¨æˆ¶->>Main: é¸æ“‡ 2. å­˜æ¬¾
    Main->>Ops: CALL 'Operations' USING 'CREDIT'
    Ops->>ç”¨æˆ¶: æç¤º: è¼¸å…¥å­˜æ¬¾é‡‘é¡
    ç”¨æˆ¶->>Ops: è¼¸å…¥é‡‘é¡ (ä¾‹: 500.00)
    Ops->>Data: CALL 'DataProgram' USING 'READ'
    Data-->>Ops: è¿”å›ç•¶å‰é¤˜é¡ 1000.00
    Ops->>Ops: è¨ˆç®—: 1000.00 + 500.00 = 1500.00
    Ops->>Data: CALL 'DataProgram' USING 'WRITE' 1500.00
    Data->>Data: æ›´æ–° STORAGE-BALANCE = 1500.00
    Data-->>Ops: å¯«å…¥å®Œæˆ
    Ops-->>Main: é¡¯ç¤º: å­˜æ¬¾æˆåŠŸ, æ–°é¤˜é¡: 1500.00
    Main-->>ç”¨æˆ¶: è¿”å›é¸å–®
```

### ææ¬¾æµç¨‹ (DEBIT) - æˆåŠŸæ¡ˆä¾‹

```mermaid
sequenceDiagram
    participant ç”¨æˆ¶ as ğŸ‘¤ ä½¿ç”¨è€…
    participant Main as ğŸ“‹ main.cob
    participant Ops as ğŸ”§ operations.cob
    participant Data as ğŸ“ data.cob
    
    ç”¨æˆ¶->>Main: é¸æ“‡ 3. ææ¬¾
    Main->>Ops: CALL 'Operations' USING 'DEBIT '
    Ops->>ç”¨æˆ¶: æç¤º: è¼¸å…¥ææ¬¾é‡‘é¡
    ç”¨æˆ¶->>Ops: è¼¸å…¥é‡‘é¡ (ä¾‹: 300.00)
    Ops->>Data: CALL 'DataProgram' USING 'READ'
    Data-->>Ops: è¿”å›ç•¶å‰é¤˜é¡ 1500.00
    Ops->>Ops: é©—è­‰: 1500.00 >= 300.00 âœ“
    Ops->>Ops: è¨ˆç®—: 1500.00 - 300.00 = 1200.00
    Ops->>Data: CALL 'DataProgram' USING 'WRITE' 1200.00
    Data->>Data: æ›´æ–° STORAGE-BALANCE = 1200.00
    Data-->>Ops: å¯«å…¥å®Œæˆ
    Ops-->>Main: é¡¯ç¤º: ææ¬¾æˆåŠŸ, æ–°é¤˜é¡: 1200.00
    Main-->>ç”¨æˆ¶: è¿”å›é¸å–®
```

### ææ¬¾æµç¨‹ (DEBIT) - é¤˜é¡ä¸è¶³æ¡ˆä¾‹

```mermaid
sequenceDiagram
    participant ç”¨æˆ¶ as ğŸ‘¤ ä½¿ç”¨è€…
    participant Main as ğŸ“‹ main.cob
    participant Ops as ğŸ”§ operations.cob
    participant Data as ğŸ“ data.cob
    
    ç”¨æˆ¶->>Main: é¸æ“‡ 3. ææ¬¾
    Main->>Ops: CALL 'Operations' USING 'DEBIT '
    Ops->>ç”¨æˆ¶: æç¤º: è¼¸å…¥ææ¬¾é‡‘é¡
    ç”¨æˆ¶->>Ops: è¼¸å…¥é‡‘é¡ (ä¾‹: 2000.00)
    Ops->>Data: CALL 'DataProgram' USING 'READ'
    Data-->>Ops: è¿”å›ç•¶å‰é¤˜é¡ 1200.00
    Ops->>Ops: é©—è­‰: 1200.00 >= 2000.00 âœ—
    Ops-->>Main: é¡¯ç¤º: âŒ é¤˜é¡ä¸è¶³ï¼Œç„¡æ³•å®Œæˆææ¬¾
    Note over Ops,Data: ä¸åŸ·è¡Œ WRITEï¼Œé¤˜é¡ä¿æŒä¸è®Š
    Main-->>ç”¨æˆ¶: è¿”å›é¸å–®
```

### è³‡æ–™ç‹€æ…‹è½‰æ›åœ–

```mermaid
stateDiagram-v2
    [*] --> åˆå§‹åŒ–: ç¨‹å¼å•Ÿå‹•
    åˆå§‹åŒ– --> é¤˜é¡1000: STORAGE-BALANCE = 1000.00
    
    é¤˜é¡1000 --> ç­‰å¾…æ“ä½œ: é¡¯ç¤ºé¸å–®
    ç­‰å¾…æ“ä½œ --> æŸ¥è©¢: ä½¿ç”¨è€…é¸æ“‡ 1
    ç­‰å¾…æ“ä½œ --> å­˜æ¬¾æ ¡é©—: ä½¿ç”¨è€…é¸æ“‡ 2
    ç­‰å¾…æ“ä½œ --> ææ¬¾æ ¡é©—: ä½¿ç”¨è€…é¸æ“‡ 3
    ç­‰å¾…æ“ä½œ --> [*]: ä½¿ç”¨è€…é¸æ“‡ 4
    
    æŸ¥è©¢ --> ç­‰å¾…æ“ä½œ: é¡¯ç¤ºé¤˜é¡
    
    å­˜æ¬¾æ ¡é©— --> è¨ˆç®—æ–°é¤˜é¡: è®€å–é‡‘é¡
    è¨ˆç®—æ–°é¤˜é¡ --> é¤˜é¡æ›´æ–°: æ–°é¤˜é¡ = èˆŠé¤˜é¡ + å­˜æ¬¾é¡
    
    ææ¬¾æ ¡é©— --> é¤˜é¡æª¢æŸ¥: è®€å–ææ¬¾é‡‘é¡
    é¤˜é¡æª¢æŸ¥ --> ææ¬¾æˆåŠŸ: é¤˜é¡å……è¶³
    é¤˜é¡æª¢æŸ¥ --> ææ¬¾å¤±æ•—: é¤˜é¡ä¸è¶³
    ææ¬¾æˆåŠŸ --> è¨ˆç®—æ–°é¤˜é¡2: æ–°é¤˜é¡ = èˆŠé¤˜é¡ - ææ¬¾é¡
    è¨ˆç®—æ–°é¤˜é¡2 --> é¤˜é¡æ›´æ–°: æ›´æ–°
    ææ¬¾å¤±æ•— --> ç­‰å¾…æ“ä½œ: äº¤æ˜“è¢«æ‹’çµ•
    
    é¤˜é¡æ›´æ–° --> æ–°é¤˜é¡[*]: æ›´æ–°å®Œæˆ
    æ–°é¤˜é¡[*] --> ç­‰å¾…æ“ä½œ: è¿”å›é¸å–®
```
